(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["49fa7062"],{"21319b4d":function(e,a,t){t.d(a,"__esModule",{value:!0}),t.e(a,{default:function(){return ev;}});var r=t("777fffbe"),n=t("852bbaa9"),s=t("494069d8"),l=t("6841b35d");async function o(e,a){return(0,l.request)("/api/login/captcha",{method:"GET",params:{...e},...a||{}});}var i=t("632bdcc8"),d=r._(i),u=t("5fa48213"),c=n._(u),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},p=t("9707286e"),g=r._(p),h=c.forwardRef(function(e,a){return c.createElement(g.default,(0,d.default)((0,d.default)({},e),{},{ref:a,icon:f}));}),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},v=c.forwardRef(function(e,a){return c.createElement(g.default,(0,d.default)((0,d.default)({},e),{},{ref:a,icon:m}));}),x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},b=c.forwardRef(function(e,a){return c.createElement(g.default,(0,d.default)((0,d.default)({},e),{},{ref:a,icon:x}));}),y=t("b349d0ec"),M=t("d83ce756"),j=r._(M),P=t("dd897919"),w=r._(P),F=t("fab7bc72"),T=r._(F),k=t("909a3ccf"),S=r._(k),_=t("0488fdd1"),C=r._(_),A=t("351f0b18"),R=r._(A),z=t("145b9c26"),L=r._(z),I=t("20e2ba4a"),N=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],V=c.default.forwardRef(function(e,a){var t,r=R.default.useFormInstance(),n=(0,c.useState)(e.countDown||60),l=(0,S.default)(n,2),o=l[0],i=l[1],u=(0,c.useState)(!1),f=(0,S.default)(u,2),p=f[0],g=f[1],h=(0,c.useState)(),m=(0,S.default)(h,2),v=m[0],x=m[1];e.rules,e.name;var b=e.phoneName,y=e.fieldProps,M=e.onTiming,P=e.captchaTextRender,F=e.captchaProps,k=(0,T.default)(e,N),_=(t=(0,w.default)((0,j.default)().mark(function e(a){return(0,j.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(!0),e.next=4,k.onGetCaptcha(a);case 4:x(!1),g(!0),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),g(!1),x(!1),console.log(e.t0);case 13:case"end":return e.stop();}},e,null,[[0,8]]);})),function(e){return t.apply(this,arguments);});return(0,c.useImperativeHandle)(a,function(){return{startTiming:function(){return g(!0);},endTiming:function(){return g(!1);}};}),(0,c.useEffect)(function(){var a=0,t=e.countDown;return p&&(a=window.setInterval(function(){i(function(e){return e<=1?(g(!1),clearInterval(a),t||60):e-1;});},1e3)),function(){return clearInterval(a);};},[p]),(0,c.useEffect)(function(){M&&M(o);},[o,M]),(0,s.jsxs)("div",{style:(0,d.default)((0,d.default)({},null==y?void 0:y.style),{},{display:"flex",alignItems:"center"}),ref:a,children:[(0,s.jsx)(L.default,(0,d.default)((0,d.default)({},y),{},{style:(0,d.default)({flex:1,transition:"width .3s",marginRight:8},null==y?void 0:y.style)})),(0,s.jsx)(C.default,(0,d.default)((0,d.default)({style:{display:"block"},disabled:p,loading:v},F),{},{onClick:(0,w.default)((0,j.default)().mark(function e(){var a;return(0,j.default)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!b){e.next=9;break;}return e.next=4,r.validateFields([b].flat(1));case 4:return a=r.getFieldValue([b].flat(1)),e.next=7,_(a);case 7:e.next=11;break;case 9:return e.next=11,_("");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop();}},e,null,[[0,13]]);})),children:(void 0===P?function(e,a){return e?"".concat(a," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801";}:P)(p,o)}))]});}),q=(0,I.createField)(V),E=t("dee4891c"),B=t("c58e3dbf"),H=r._(B),D=t("56577abc"),G=r._(D),U=["options","fieldProps","proFieldProps","valueEnum"],$=c.default.forwardRef(function(e,a){var t=e.options,r=e.fieldProps,n=e.proFieldProps,l=e.valueEnum,o=(0,T.default)(e,U);return(0,s.jsx)(G.default,(0,d.default)({ref:a,valueType:"checkbox",valueEnum:(0,E.runFunction)(l,void 0),fieldProps:(0,d.default)({options:t},r),lightProps:(0,d.default)({labelFormatter:function(){return(0,s.jsx)(G.default,(0,d.default)({ref:a,valueType:"checkbox",mode:"read",valueEnum:(0,E.runFunction)(l,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,d.default)({options:t},r),proFieldProps:n},o));}},o.lightProps),proFieldProps:n},o));}),O=c.default.forwardRef(function(e,a){var t=e.fieldProps,r=e.children;return(0,s.jsx)(H.default,(0,d.default)((0,d.default)({ref:a},t),{},{children:r}));}),W=(0,I.createField)(O,{valuePropName:"checked"});W.Group=$;var K=t("fcbf23c1"),Q=t("187773f5"),J=r._(Q),X=t("7720ec57"),Y=r._(X),Z=["fieldProps","proFieldProps"],ee=["fieldProps","proFieldProps"],ea="text",et=function(e){var a=(0,K.useMountMergeState)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),t=(0,S.default)(a,2),r=t[0],n=t[1];return(0,s.jsx)(R.default.Item,{shouldUpdate:!0,noStyle:!0,children:function(a){var t,l=a.getFieldValue(e.name||[]);return(0,s.jsx)(J.default,(0,d.default)((0,d.default)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e;},onOpenChange:function(e){return n(e);},content:(0,s.jsxs)("div",{style:{padding:"4px 0"},children:[null===(t=e.statusRender)||void 0===t?void 0:t.call(e,l),e.strengthText?(0,s.jsx)("div",{style:{marginTop:10},children:(0,s.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:r,children:e.children}));}});},er=function(e){var a=e.fieldProps,t=e.proFieldProps,r=(0,T.default)(e,Z);return(0,s.jsx)(G.default,(0,d.default)({valueType:ea,fieldProps:a,filedConfig:{valueType:ea},proFieldProps:t},r));};er.Password=function(e){var a=e.fieldProps,t=e.proFieldProps,r=(0,T.default)(e,ee),n=(0,c.useState)(!1),l=(0,S.default)(n,2),o=l[0],i=l[1];return null!=a&&a.statusRender&&r.name?(0,s.jsx)(et,{name:r.name,statusRender:null==a?void 0:a.statusRender,popoverProps:null==a?void 0:a.popoverProps,strengthText:null==a?void 0:a.strengthText,open:o,onOpenChange:i,children:(0,s.jsx)("div",{children:(0,s.jsx)(G.default,(0,d.default)({valueType:"password",fieldProps:(0,d.default)((0,d.default)({},(0,Y.default)(a,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var t;null==a||null===(t=a.onBlur)||void 0===t||t.call(a,e),i(!1);},onClick:function(e){var t;null==a||null===(t=a.onClick)||void 0===t||t.call(a,e),i(!0);}}),proFieldProps:t,filedConfig:{valueType:ea}},r))})}):(0,s.jsx)(G.default,(0,d.default)({valueType:"password",fieldProps:a,proFieldProps:t,filedConfig:{valueType:ea}},r));},er.displayName="ProFormComponent";var en=t("ba2c4f58"),es=r._(en),el=t("ab330f61"),eo=r._(el),ei=t("a02c5c30"),ed=r._(ei),eu=t("e15da989"),ec=t("6a4c5703"),ef=t("4c458304"),ep=r._(ef);let eg=(0,eu.createStyles)(({token:e})=>({action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:e.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:e.borderRadius,":hover":{backgroundColor:e.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}})),eh=()=>{let{styles:e}=eg();return(0,s.jsx)("div",{className:e.lang,"data-lang":!0,children:l.SelectLang&&(0,s.jsx)(l.SelectLang,{})});},em=({content:e})=>(0,s.jsx)(es.default,{style:{marginBottom:24},message:e,type:"error",showIcon:!0}),ev=()=>{let[e,a]=(0,c.useState)({}),[t,r]=(0,c.useState)("account"),{initialState:n,setInitialState:i}=(0,l.useModel)("@@initialState"),{styles:d}=eg(),u=(0,l.useIntl)(),f=async()=>{var e;let a=await (null==n?void 0:null===(e=n.fetchUserInfo)||void 0===e?void 0:e.call(n));a&&(0,ec.flushSync)(()=>{i(e=>({...e,currentUser:a}));});},p=async e=>{try{let e={};if(e={status:"ok",currentAuthority:"admin",type:"account"},"ok"===e.status){let e=u.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"});eo.default.success(e),await f();let a=new URL(window.location.href).searchParams;console.log(a),l.history.push(a.get("redirect")||"/");return;}console.log(e),a(e);}catch(a){let e=u.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"});console.log(a),eo.default.error(e);}},{status:g,type:m}=e;return(0,s.jsxs)("div",{className:d.container,children:[(0,s.jsx)(l.Helmet,{children:(0,s.jsxs)("title",{children:[u.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),ep.default.title&&` - ${ep.default.title}`]})}),(0,s.jsx)(eh,{}),(0,s.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,s.jsxs)(y.LoginForm,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,s.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"Ant Design",subTitle:u.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0,username:"admin",password:"ant.design"},onFinish:async e=>{await p(e);},children:[(0,s.jsx)(ed.default,{activeKey:t,onChange:r,centered:!0,items:[{key:"account",label:u.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"mobile",label:u.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),"error"===g&&"account"===m&&(0,s.jsx)(em,{content:u.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),"account"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{name:"username",fieldProps:{size:"large",prefix:(0,s.jsx)(b,{})},placeholder:u.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,s.jsx)(er.Password,{name:"password",fieldProps:{size:"large",prefix:(0,s.jsx)(h,{})},placeholder:u.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),"error"===g&&"mobile"===m&&(0,s.jsx)(em,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),"mobile"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{fieldProps:{size:"large",prefix:(0,s.jsx)(v,{})},name:"mobile",placeholder:u.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,s.jsx)(q,{fieldProps:{size:"large",prefix:(0,s.jsx)(h,{})},captchaProps:{size:"large"},placeholder:u.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:(e,a)=>e?`${a} ${u.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})}`:u.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"}),name:"captcha",rules:[{required:!0,message:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:async e=>{await o({phone:e})&&eo.default.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");}})]}),(0,s.jsxs)("div",{style:{marginBottom:24},children:[(0,s.jsx)(W,{noStyle:!0,name:"autoLogin",children:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,s.jsx)("a",{style:{float:"right"},children:(0,s.jsx)(l.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})})]});};}}]);
//# sourceMappingURL=49fa7062-async.fdcb0877.js.map